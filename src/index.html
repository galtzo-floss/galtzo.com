---
layout: default
title: Open Source Projects
permalink: /
body_class: projects
---

<h1><%= (page.respond_to?(:data) && page.data["title"]) || "Open Source Projects" %></h1>

<% tags = site.data.projects.flat_map { |project| project["tags"] || [] }.uniq.sort %>
<% tag_counts = {} %>
<% site.data.projects.each do |project| %>
  <% (project["tags"] || []).each do |tag| %>
    <% tag_counts[tag] ||= 0 %>
    <% tag_counts[tag] += 1 %>
  <% end %>
<% end %>

<% bash_projects = site.data.projects.select {|p| p["language"] == "Bash" } %>
<% min_bash_versions = bash_projects.flat_map { |project| project["minimum_version"] || [] }.uniq.sort %>
<% min_bash_counts = {} %>
<% bash_projects.each do |project| %>
  <% if project["minimum_version"] %>
    <% min_bash_counts[project["minimum_version"]] ||= 0 %>
    <% min_bash_counts[project["minimum_version"]] += 1 %>
  <% end %>
<% end %>

<% ts_projects = site.data.projects.select {|p| p["language"] == "TypeScript" } %>
<% min_ts_versions = ts_projects.flat_map { |project| project["minimum_version"] || [] }.uniq.sort %>
<% min_ts_counts = {} %>
<% ts_projects.each do |project| %>
  <% if project["minimum_version"] %>
    <% min_ts_counts[project["minimum_version"]] ||= 0 %>
    <% min_ts_counts[project["minimum_version"]] += 1 %>
  <% end %>
<% end %>

<% rb_projects = site.data.projects.select {|p| p["language"] == "Ruby" } %>
<% min_rb_versions = rb_projects.flat_map { |project| project["minimum_version"] || [] }.uniq.sort %>
<% min_rb_counts = {} %>
<% rb_projects.each do |project| %>
  <% if project["minimum_version"] %>
    <% min_rb_counts[project["minimum_version"]] ||= 0 %>
    <% min_rb_counts[project["minimum_version"]] += 1 %>
  <% end %>
<% end %>

<ul class="tag-list">
  <% tags.each do |tag| %>
    <li>
      <a href="#" class="tag-link" data-tag="<%= tag %>">
        <span class="count left"><%== tag_counts[tag].to_s.rjust(2, 'x').gsub('x', '&nbsp;') %></span>
        <span class="tag <%= tag %>"><%= tag %></span>
        <span class="count right"><%== tag_counts[tag].to_s.ljust(2, 'x').gsub('x', '&nbsp;') %></span>
      </a>
    </li>
  <% end %>
  <% min_rb_versions.each do |min_ruby| %>
    <li>
      <a href="#" class="tag-link min_lang-link" data-tag="Ruby >= <%= min_ruby %>">
        <span class="count left"><%== min_rb_counts[min_ruby].to_s.rjust(2, 'x').gsub('x', '&nbsp;') %></span>
        <span class="tag min-language"><img
                src="/assets/images/Ruby.svg"
                alt="Ruby >= <%= min_ruby %>"
                class="language"
        >Min Ruby v<%= min_ruby %></span>
        <span class="count right"><%== min_rb_counts[min_ruby].to_s.ljust(2, 'x').gsub('x', '&nbsp;') %></span>
      </a>
    </li>
  <% end %>
  <% min_ts_versions.each do |min_ts| %>
    <li>
      <a href="#" class="tag-link min_lang-link" data-tag="TypeScript >= <%= min_ts %>">
        <span class="count left"><%== min_ts_counts[min_ts].to_s.rjust(2, 'x').gsub('x', '&nbsp;') %></span>
        <span class="tag min-language"><img
                src="/assets/images/TypeScript.svg"
                alt="TypeScript >= <%= min_ts %>"
                class="language"
        >Min TS v<%= min_ts %></span>
        <span class="count right"><%== min_ts_counts[min_ts].to_s.ljust(2, 'x').gsub('x', '&nbsp;') %></span>
      </a>
    </li>
  <% end %>
  <% min_bash_versions.each do |min_bash| %>
  <li>
    <a href="#" class="tag-link min_lang-link" data-tag="Bash >= <%= min_bash %>">
      <span class="count left"><%== min_bash_counts[min_bash].to_s.rjust(2, 'x').gsub('x', '&nbsp;') %></span>
      <span class="tag min-language"><img
              src="/assets/images/Bash.svg"
              alt="TypeScript >= <%= min_bash %>"
              class="language"
      >Min Bash v<%= min_bash %></span>
      <span class="count right"><%== min_bash_counts[min_bash].to_s.ljust(2, 'x').gsub('x', '&nbsp;') %></span>
    </a>
  </li>
  <% end %>
</ul>

<ul class="project-list">
  <% site.data.projects.each do |project| %>
  <li class="card">
    <h2>
      <a href="https://bestgems.org/gems/<%= project['name'] %>" class="gem-link" target="_blank" rel="noopener">
        <%= project["name"] %>
      </a>
    </h2>
    <p>
      <a href="https://bestgems.org/gems/<%= project['name'] %>" class="gem-link" target="_blank" rel="noopener">
        <img
                src="/assets/images/<%= project['language'] %>.svg"
                alt="language: <%= project['language'] %>"
                class="link-icon language"
        >
      </a>
      <% if !project["funding_sites"].nil? %>
        <% project["funding_sites"].each do |funding_site| %>
          <a href="<%= funding_site['url'] %>" class="funding-link" target="_blank" rel="noopener">
            <img
                    src="/assets/images/<%= funding_site['type'] %>.svg"
                    alt="Documentation Website (<%= funding_site['url'] %>)"
                    class="link-icon funding-site"
            >
          </a>
        <% end %>
      <% else %>
        <a href="https://liberapay.com/pboling" class="funding-link" target="_blank" rel="noopener">
          <img
                  src="/assets/images/Liberapay.svg"
                  alt="This project has no funding links. Please donate to me directly!"
                  class="link-icon funding-site"
          >
        </a>
      <% end %>
      <% if !project["doc_site"].nil? %>
        <a href="<%= project['doc_site'] %>" class="doc-link" target="_blank" rel="noopener">
          <img
                  src="/assets/images/Read-the-Docs.svg"
                  alt="Documentation Website (<%= project['doc_site'] %>)"
                  class="link-icon doc-site"
          >
        </a>
      <% end %>
      <% project["forges"].each do |forge| %>
        <a href="<%= forge['url'] %>" class="forge-link" target="_blank" rel="noopener">
          <img
                  src="/assets/images/<%= forge['type'] %>.svg"
                  alt="forge: <%= forge['type'] %> (<%= forge['url'] %>)"
                  class="link-icon forge"
          >
        </a>
      <% end %>
    </p>
    <p>
      <% if !project["minimum_version"].nil? %>
        <span class="tag min-language"><img
                src="/assets/images/<%= project['language'] %>.svg"
                alt="<%= project['language'] %> >= <%= project['minimum_version'] %>"
                class="language"
        ><%= project["language"] %> >= <%= project["minimum_version"] %></span>
      <% end %>
      <% if project["tags"] && project["tags"].any? %>
        <% project["tags"].each do |tag| %>
          <span class="tag <%= tag %>"><%= tag %></span>
        <% end %>
      <% else %>
        <span class="tag oops">Oops</span>
      <% end %>
    </p>
    <p><%= project["description"] %></p>
    <p>
      Financially support <%= project["name"] %> via:
      <% if !project["funding_sites"].nil? %>
        <% last_comma_index = project["funding_sites"].size - 1 %>
        <% project["funding_sites"].each_with_index do |funding_site, i| %>
          <a href="<%= funding_site['url'] %>" class="text-link" target="_blank" rel="noopener">
            <%= funding_site['type'] %>
          </a><%= i <= last_comma_index - 1 ? ", " : "" %><%= i == last_comma_index - 1 ? "or" : "" %>
        <% end %>
      <% else %>
        <a href="https://liberapay.com/pboling" class="text-link" target="_blank" rel="noopener">
          Liberapay
        </a>
      <% end %>
    </p>
  </li>
  <% end %>
</ul>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tagLinks = document.querySelectorAll('.tag-link');
  const cards = document.querySelectorAll('.card');

  tagLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      this.classList.toggle('active');
      filterProjects();
    });
  });

  function filterProjects() {
    const activeTags = Array.from(document.querySelectorAll('.tag-link.active')).map(link => link.dataset.tag);
    cards.forEach(card => {
      const cardTags = Array.from(card.querySelectorAll('.tag')).map(span => span.textContent.trim());
      const matches = activeTags.length === 0 || activeTags.every(tag => cardTags.includes(tag));
      card.style.display = matches ? '' : 'none';
    });
  }
});
</script>
